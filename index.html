<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>WebRTC Cámara – Emisor / Viewer</title>
<style>
  body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Inter,Helvetica,Arial,sans-serif;margin:0;padding:16px;background:#0b0f14;color:#e6eef8}
  .card{max-width:980px;margin:0 auto;background:#121922;border:1px solid #1e2a36;border-radius:14px;padding:16px}
  h1{margin:0 0 12px;font-size:20px}
  .row{display:flex;gap:12px;flex-wrap:wrap;margin:10px 0}
  label{font-size:14px;opacity:.9}
  select,input,button{background:#0f151d;color:#e6eef8;border:1px solid #2a3a4d;border-radius:10px;padding:8px 10px}
  button{cursor:pointer}
  button.primary{background:#1d6fff;border-color:#2a72ff}
  video{width:100%;max-height:70vh;background:#000;border-radius:12px}
  .hint{font-size:12px;opacity:.8}
  .url{font-family:ui-monospace,SFMono-Regular,Menlo,Consolas,monospace;background:#0f151d;border:1px dashed #2a3a4d;padding:8px;border-radius:10px;word-break:break-all}
  .ok{color:#7be59b} .warn{color:#ffd166} .err{color:#ff6b6b}
</style>
</head>
<body>
<div class="card">
  <h1>WebRTC Cámara – Emisor / Viewer</h1>

  <div class="row">
    <label>Rol:</label>
    <select id="role">
      <option value="emitter">Emisor (envía cámara)</option>
      <option value="viewer">Viewer (sólo ve)</option>
    </select>

    <label> Sala:</label>
    <input id="room" placeholder="p.ej. casa1" />

    <button id="start" class="primary">Iniciar</button>
    <button id="stop" disabled>Detener</button>
  </div>

  <div class="row" id="emitterOpts" style="display:none">
    <label>Cámara:</label>
    <select id="cameraSelect"></select>
    <label><input type="checkbox" id="mirror" checked /> Espejo (selfie)</label>
    <label><input type="checkbox" id="sendAudio" /> Enviar audio</label>
  </div>

  <p class="hint">Comparte este link con el Viewer cuando seas Emisor:</p>
  <div id="shareUrl" class="url"></div>

  <video id="video" autoplay playsinline muted></video>
  <p id="status" class="hint"></p>
</div>

<!-- Firebase compat SDKs -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

<script>
(async () => {
  // ========= Configuración de Firebase =========
  const firebaseConfig = {
    apiKey: "AIzaSyDb_q-2SL_x-Xj4aBrpN4D57N7zMgQmYjw",
    authDomain: "camara-ipad.firebaseapp.com",
    projectId: "camara-ipad",
    storageBucket: "camara-ipad.firebasestorage.app",
    messagingSenderId: "891674821126",
    appId: "1:891674821126:web:c3cefb5dc4cbc5f08f7987"
  };
  const app = firebase.initializeApp(firebaseConfig);
  const db = firebase.firestore();

  // ========= resto del código WebRTC =========
  // (idéntico al que ya pegamos antes: UI refs, updateUI, listCams, start(), stop(), etc.)
})();
</script>
</body>
</html>

